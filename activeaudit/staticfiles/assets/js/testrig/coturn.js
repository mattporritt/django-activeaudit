// @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
"use strict";const allServersKey="servers",servers=document.getElementById("testservers"),serverurl=document.getElementById("serverurl"),usernameInput=document.getElementById("username"),passwordInput=document.getElementById("password"),addBtn=document.getElementById("btn-add-server"),removeBtn=document.getElementById("btn-remove-server"),iceTransportsAll=document.getElementById("transportall"),iceTransportsRelay=document.getElementById("transportrelay"),iceCandidatePool=document.getElementById("poolval"),gatherBtn=document.getElementById("btn-add-candidates"),tableBody=document.getElementById("tbl-body-candidates"),writeServersToLocalStorage=()=>{const e=document.getElementById("testservers"),r=JSON.stringify(Object.values(e.options).map((e=>JSON.parse(e.value))));window.localStorage.setItem("servers",r)},selectServerAcn=e=>{const r=e.target,t=JSON.parse(r.value);serverurl.value=t.urls[0],usernameInput.value=t.username||"",passwordInput.value=t.credential||""},addServerAcn=()=>{const e=serverurl.value.split(":")[0],r=document.createElement("option"),t=usernameInput.value,n=passwordInput.value;if("stun"!==e&&"turn"!==e&&"turns"!==e)return void alert(`URI scheme ${e} is not valid`);const s={urls:[serverurl.value],username:usernameInput.value,credential:passwordInput.value};r.value=JSON.stringify(s),r.text=`${serverurl.value} `,(t||n)&&(r.text+=` [${t}:${n}]`),r.ondblclick=selectServerAcn,servers.add(r),serverurl.value=usernameInput.value=passwordInput.value="",writeServersToLocalStorage()},removeServerAcn=()=>{for(let e=servers.options.length-1;e>=0;--e)servers.options[e].selected&&servers.remove(e);writeServersToLocalStorage()},addEventListeners=()=>{addBtn.onclick=addServerAcn,removeBtn.onclick=removeServerAcn};export const init=()=>{window.console.log("Coturn testrig JS."),addBtn.onclick=addServerAcn,removeBtn.onclick=removeServerAcn};